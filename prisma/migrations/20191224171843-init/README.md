# Migration `20191224171843-init`

This migration has been generated by Tom Houl√© at 12/24/2019, 5:18:43 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "sql_load_test"."User" (
  "age" integer    ,
  "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "email" text    ,
  "firstName" text  NOT NULL DEFAULT '' ,
  "id" integer  NOT NULL  ,
  "lastName" text  NOT NULL DEFAULT '' ,
  "password" text    ,
  "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "sql_load_test"."Post" (
  "content" text    ,
  "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "id" integer  NOT NULL  ,
  "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "sql_load_test"."Comment" (
  "content" text    ,
  "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "id" integer  NOT NULL  ,
  "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "sql_load_test"."Like" (
  "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "id" integer  NOT NULL  ,
  "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "sql_load_test"."_FriendShip" (
  "A" integer  NOT NULL  REFERENCES "sql_load_test"."User"("id") ON DELETE CASCADE,
  "B" integer  NOT NULL  REFERENCES "sql_load_test"."User"("id") ON DELETE CASCADE
);

ALTER TABLE "sql_load_test"."Post" ADD COLUMN "author" integer  NOT NULL  REFERENCES "sql_load_test"."User"("id") ON DELETE RESTRICT;

ALTER TABLE "sql_load_test"."Comment" ADD COLUMN "author" integer  NOT NULL  REFERENCES "sql_load_test"."User"("id") ON DELETE RESTRICT,
ADD COLUMN "post" integer  NOT NULL  REFERENCES "sql_load_test"."Post"("id") ON DELETE RESTRICT;

ALTER TABLE "sql_load_test"."Like" ADD COLUMN "comment" integer  NOT NULL  REFERENCES "sql_load_test"."Comment"("id") ON DELETE RESTRICT,
ADD COLUMN "post" integer  NOT NULL  REFERENCES "sql_load_test"."Post"("id") ON DELETE RESTRICT,
ADD COLUMN "user" integer  NOT NULL  REFERENCES "sql_load_test"."User"("id") ON DELETE RESTRICT;

CREATE  INDEX "Post.author" ON "sql_load_test"."Post"("author")

CREATE  INDEX "Comment.author" ON "sql_load_test"."Comment"("author")

CREATE  INDEX "Comment.post" ON "sql_load_test"."Comment"("post")

CREATE  INDEX "Like.user" ON "sql_load_test"."Like"("user")

CREATE  INDEX "Like.post" ON "sql_load_test"."Like"("post")

CREATE  INDEX "Like.comment" ON "sql_load_test"."Like"("comment")

CREATE UNIQUE INDEX "_FriendShip_AB_unique" ON "sql_load_test"."_FriendShip"("A","B")
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20191224171843-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,62 @@
+datasource db {
+  provider = "postgresql"
+  url      = "postgresql://postgres:prisma@localhost:5432/postgres?schema=sql_load_test"
+}
+
+generator photon {
+  provider = "photonjs"
+}
+
+model User {
+  id         Int       @id
+  firstName  String
+  lastName   String
+  age        Int?
+  email      String?
+  password   String?
+  posts      Post[]
+  comments   Comment[]
+  likes      Like[]
+  friendWith User[]    @relation("FriendShip")
+  friendOf   User[]    @relation("FriendShip")
+  createdAt  DateTime  @default(now())
+  updatedAt  DateTime  @updatedAt
+}
+
+model Post {
+  id        Int       @id
+  content   String?
+  author    User
+  comments  Comment[]
+  likes     Like[]
+  createdAt DateTime  @default(now())
+  updatedAt DateTime  @updatedAt
+
+  @@index([author])
+}
+
+model Comment {
+  id        Int      @id
+  content   String?
+  author    User
+  post      Post
+  likes     Like[]
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  @@index([author])
+  @@index([post])
+}
+
+model Like {
+  id        Int      @id
+  user      User
+  post      Post
+  comment   Comment
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  @@index([user])
+  @@index([post])
+  @@index([comment])
+}
```


