# Migration `20191023130149-init`

This migration has been generated by Julius de Bruijn at 10/23/2019, 1:01:49 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "sql_load_test"."User" (
  "age" integer   ,
  "createdAt" timestamp(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "email" text   ,
  "firstName" text NOT NULL DEFAULT '' ,
  "id" SERIAL,
  "lastName" text NOT NULL DEFAULT '' ,
  "password" text   ,
  "updatedAt" timestamp(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "sql_load_test"."Post" (
  "content" text   ,
  "createdAt" timestamp(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "id" SERIAL,
  "updatedAt" timestamp(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "sql_load_test"."Comment" (
  "content" text   ,
  "id" SERIAL,
  PRIMARY KEY ("id")
);

CREATE TABLE "sql_load_test"."Like" (
  "id" SERIAL,
  PRIMARY KEY ("id")
);

CREATE TABLE "sql_load_test"."Group" (
  "description" text   ,
  "id" SERIAL,
  "topic" text NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "sql_load_test"."_FriendShip" (
  "A" integer   REFERENCES "sql_load_test"."User"("id") ON DELETE CASCADE,
  "B" integer   REFERENCES "sql_load_test"."User"("id") ON DELETE CASCADE
);

CREATE TABLE "sql_load_test"."_GroupToUser" (
  "A" integer   REFERENCES "sql_load_test"."Group"("id") ON DELETE CASCADE,
  "B" integer   REFERENCES "sql_load_test"."User"("id") ON DELETE CASCADE
);

ALTER TABLE "sql_load_test"."Post" ADD COLUMN "author" integer   REFERENCES "sql_load_test"."User"("id") ON DELETE SET NULL;

ALTER TABLE "sql_load_test"."Comment" ADD COLUMN "author" integer   REFERENCES "sql_load_test"."User"("id") ON DELETE SET NULL,
ADD COLUMN "post" integer   REFERENCES "sql_load_test"."Post"("id") ON DELETE SET NULL;

ALTER TABLE "sql_load_test"."Like" ADD COLUMN "comment" integer   REFERENCES "sql_load_test"."Comment"("id") ON DELETE SET NULL,
ADD COLUMN "post" integer   REFERENCES "sql_load_test"."Post"("id") ON DELETE SET NULL,
ADD COLUMN "user" integer   REFERENCES "sql_load_test"."User"("id") ON DELETE SET NULL;

CREATE UNIQUE INDEX "User.id" ON "sql_load_test"."User"("id")

CREATE UNIQUE INDEX "Post.id" ON "sql_load_test"."Post"("id")

CREATE UNIQUE INDEX "Comment.id" ON "sql_load_test"."Comment"("id")

CREATE UNIQUE INDEX "Like.id" ON "sql_load_test"."Like"("id")

CREATE UNIQUE INDEX "Group.id" ON "sql_load_test"."Group"("id")

CREATE UNIQUE INDEX "_FriendShip_AB_unique" ON "sql_load_test"."_FriendShip"("A","B")

CREATE UNIQUE INDEX "_GroupToUser_AB_unique" ON "sql_load_test"."_GroupToUser"("A","B")
```

## Changes

```diff
diff --git datamodel.mdl datamodel.mdl
migration ..20191023130149-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,57 @@
+datasource db {
+  provider = "postgresql"
+  url      = "postgresql://postgres:prisma@localhost:5432/postgres?schema=sql_load_test"
+}
+
+generator photon {
+  provider = "photonjs"
+}
+
+model User {
+  id         Int       @id @unique
+  firstName  String
+  lastName   String
+  age        Int?
+  email      String?
+  password   String?
+  posts      Post[]
+  comments   Comment[]
+  likes      Like[]
+  friendWith User[]    @relation("FriendShip")
+  friendOf   User[]    @relation("FriendShip")
+  groups     Group[]
+  createdAt  DateTime  @default(now())
+  updatedAt  DateTime  @updatedAt
+}
+
+model Post {
+  id        Int       @id @unique
+  content   String?
+  author    User
+  comments  Comment[]
+  likes     Like[]
+  createdAt DateTime  @default(now())
+  updatedAt DateTime  @updatedAt
+}
+
+model Comment {
+  id        Int       @id @unique
+  content   String?
+  author    User
+  post      Post
+  likes     Like[]
+}
+
+model Like {
+  id        Int       @id @unique
+  user      User
+  post      Post
+  comment   Comment
+}
+
+model Group {
+  id          Int       @id @unique
+  topic       String
+  description String?
+  members     User[]
+}
```

## Photon Usage

You can use a specific Photon built for this migration (20191023130149-init)
in your `before` or `after` migration script like this:

```ts
import Photon from '@generated/photon/20191023130149-init'

const photon = new Photon()

async function main() {
  const result = await photon.users()
  console.dir(result, { depth: null })
}

main()

```
